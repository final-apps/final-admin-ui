"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[146],{29695:function(le,M,e){e.r(M),e.d(M,{default:function(){return te}});var A=e(15009),d=e.n(A),Z=e(99289),g=e.n(Z),b=e(5574),C=e.n(b),B=e(97857),h=e.n(B),O=e(13769),$=e.n(O),N=e(79346),x=e(80854);function G(o,t){return R.apply(this,arguments)}function R(){return R=g()(d()().mark(function o(t,r){return d()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,x.request)("/api/security/menus",h()({method:"GET",params:h()({},t)},r||{})));case 1:case"end":return n.stop()}},o)})),R.apply(this,arguments)}var y=e(67294),T=e(15867),U=e(11774),J=e(87801),Q=e(76150),H=e(76971),K=e(12444),L=e.n(K),W=e(72004),Y=e.n(W),z=e(9783),V=e.n(z),X=function(){function o(t){L()(this,o),V()(this,"resource",void 0),this.resource=t}return Y()(o,[{key:"list",value:function(r,a){if(console.log("resource:".concat(this.resource)),console.log("options:"+JSON.stringify(a)),a){var n=Object.keys(a)[0],u=Object.values(a)[0];n&&(console.log("order:"+n+"="+u),u==="ascend"?r.orders=n:r.orders=n+" desc",console.log("params:"+JSON.stringify(r)))}return(0,x.request)("/api/".concat(this.resource),h()({method:"GET",params:h()({},r)},a||{}))}},{key:"sort",value:function(){var t=g()(d()().mark(function a(n,u){var i,f;return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:for(i={},f=0;f<n.length;f++)i[n[f].id]=f;return l.abrupt("return",(0,x.request)("/api/".concat(this.resource,"/sort"),h()({method:"PATCH",data:i},u||{})));case 3:case"end":return l.stop()}},a,this)}));function r(a,n){return t.apply(this,arguments)}return r}()}]),o}(),k=e(5452),w=e(36683),E=e(67610),s=e(85893),P=(0,w.Z)({scriptUrl:E.Z.iconfontUrl}),D=[{title:"\u6392\u5E8F",dataIndex:"sort",width:60,className:"drag-visible",hideInForm:!0},{title:"#",dataIndex:"index",valueType:"indexBorder"},{title:"\u7F16\u7801",dataIndex:"code"},{title:"\u540D\u79F0",dataIndex:"name",render:function(t,r){return(0,s.jsxs)("a",{onClick:function(){console.log(r)},children:[(0,s.jsx)(P,{type:"icon-"+r.icon})," ",r.name]})}},{title:"\u8DEF\u5F84",dataIndex:"path"},{title:"\u8DEF\u5F84",dataIndex:"icon",render:function(t,r){return(0,s.jsx)(P,{type:"icon-"+r.icon})}},{title:"\u6392\u5E8F",dataIndex:"sortValue",sorter:!0,hideInTable:!0,hideInSearch:!0,defaultSortOrder:"ascend"}],q=function(t){var r=new X("security-menus"),a=function(u){console.log("\u6392\u5E8F\u540E\u7684\u6570\u636E",u),r.sort(u).then(function(){var i;(i=t.actionRef.current)===null||i===void 0||i.reload(),t.onDragSortEnd(),Q.ZP.success("\u4FEE\u6539\u5217\u8868\u6392\u5E8F\u6210\u529F")})};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(J.Z,{headerTitle:"\u5B50\u83DC\u5355",columns:D,rowKey:"id",pagination:!1,dragSortKey:"sort",formRef:t.formRef,actionRef:t.actionRef,params:t.securityMenuQuery,request:function(){var n=g()(d()().mark(function u(i,f){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,r.list(i,f);case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},u)}));return function(u,i){return n.apply(this,arguments)}}(),onDragSortEnd:a,search:!1,toolbar:{actions:[(0,s.jsx)(k.Z,{trigger:(0,s.jsxs)(T.ZP,{type:"primary",children:[(0,s.jsx)(H.Z,{}),"\u70B9\u51FB\u6211"]}),layoutType:"ModalForm",onFinish:function(){var n=g()(d()().mark(function u(i){return d()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:console.log(i);case 1:case"end":return m.stop()}},u)}));return function(u){return n.apply(this,arguments)}}(),columns:D},"add")]}})})},_=q,ee=function(){return(0,s.jsx)("p",{children:"\u6743\u9650"})},ne=["icon","routes"],re=function o(t){return t.map(function(r){var a=r.icon,n=r.routes,u=$()(r,ne);return h()(h()({},u),{},{icon:a&&"icon-"+a,children:n&&o(n)})})},te=function(){var o=(0,y.useRef)(),t=(0,y.useRef)(),r=(0,y.useRef)(),a=(0,y.useState)({parentId:-1}),n=C()(a,2),u=n[0],i=n[1],f=[{key:"menus",tab:"\u5B50\u83DC\u5355",children:(0,s.jsx)(_,{parentId:-1,formRef:r,actionRef:t,securityMenuQuery:u,onDragSortEnd:function(){var v;return(v=o.current)===null||v===void 0?void 0:v.reload()}})},{key:"authorities",tab:"\u6743\u9650",children:(0,s.jsx)(ee,{})}],m=(0,y.useState)("menus"),l=C()(m,2),ae=l[0],ue=l[1],se=(0,y.useState)("/"),F=C()(se,2),oe=F[0],ie=F[1];return(0,s.jsx)(N.f,{title:"\u83DC\u5355\u8BBE\u7F6E",logo:"https://th.bing.com/th/id/R.c3ec64ad2cc5dbe33e74b212dc1b655b?rik=2iSUEjTG8e%2balA&riu=http%3a%2f%2fpic.616pic.com%2fys_b_img%2f00%2f15%2f34%2fMgf5DOge2w.jpg&ehk=YJ4I33FCI9wOYNRi%2bx%2fqT%2fvMy5cTmmq9hN5yX%2bwsEsc%3d&risl=&pid=ImgRaw&r=0&sres=1&sresct=1",collapsedButtonRender:!1,fixSiderbar:!0,actionRef:o,iconfontUrl:E.Z.iconfontUrl,onMenuHeaderClick:function(){return history.back()},menuProps:{style:{}},location:{pathname:oe},menu:{request:function(){var p=g()(d()().mark(function j(){var I;return d()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,G({});case 2:return I=c.sent,c.abrupt("return",re(I.data));case 4:case"end":return c.stop()}},j)}));function v(){return p.apply(this,arguments)}return v}()},menuItemRender:function(v,j){return(0,s.jsx)("a",{onClick:function(){var S;console.log(JSON.stringify(v));var c=parseInt(v.key||"-1");c!==-1&&(c=Math.abs(c)),ie(v.path||"/"),(S=t.current)===null||S===void 0||S.reload(),i({parentId:c})},children:j})},children:(0,s.jsx)(U._z,{extra:[(0,s.jsx)(T.ZP,{type:"primary",children:"\u4E3B\u64CD\u4F5C"},"1")],tabList:f,tabActiveKey:ae,onTabChange:ue})})}}}]);
